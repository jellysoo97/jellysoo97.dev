---
title: 변수와 메모리
description: 변수 타입에 따른 자바스크립트의 메모리 할당
date: 2024-10-12 22:45:59
tag: javascript
draft: true
---

## 메모리

### 데이터는 메모리에 저장

![변수1](/images/posts/js-variable-and-memory/1.png)

컴퓨터의 핵심 부품 중에 메모리와 CPU가 있다.
메모리에 명령어와 데이터를 저장하고, CPU가 메모리에 저장된 명령어와 데이터를 읽어들여 해석하고 실행한다.
메모리는 수많은 메모리 셸들로 구성되어 있고, 하나의 메모리 셸은 1바이트(8비트) 크기이다.
데이터는 메모리 셸들에 저장된다. 이 때 모든 데이터는 2진수로 저장된다.

<br />

메모리의 셸은 **고유한 주소**를 가진다.
주소는 곧 메모리 공간에서의 위치를 의미하며, 고유한 주소를 통해 데이터에 접근할 수 있다.
메모리 주소는 0부터 메모리 크기만큼의 정수(ex. 0x00000C)로 표현된다.

## 변수

### 변수는 메모리 주소에 붙인 이름

![변수2](/images/posts/js-variable-and-memory/2.png)

메모리 주소를 알면 값이 저장된 위치를 아는 것이기 때문에 원하는 값에 접근할 수 있다.
하지만 문제는 메모리 주소를 **재사용 할 수 없다**는 점이다.

1. 메모리 주소는 프로그램을 실행할 때마다 바뀔 뿐만 아니라

2. 메모리 주소를 통해 값에 직접 접근하는 것은 위험하기 때문에 자바스크립트는 개발자의 직접적인 메모리 제어를 제한한다.

그래서 변수가 필요하다. **데이터를 저장하고 저장된 값에 접근하여 재사용하기 위해** 변수를 사용한다.
변수는 **식별자**이기도 하다. 식별자란 어떤 값을 식별할 수 있는 고유한 이름을 뜻한다.
변수는 고유한 메모리 주소를 기억하고 있기 때문에 식별자이다. 변수 외에 함수, 클래스 등도 식별자이다.

<br />

변수를 사용하려면 식별자의 존재를 자바스크립트 엔진에 알려야 한다.
**변수 선언 -> 변수 초기화 -> 값 할당**의 과정을 거친다.

```js
var score = 'score'
```

위 코드는 선언문과 할당문이 합쳐진 형태지만 `var score;`(변수 선언) -> 변수 초기화 -> `score = 'score';`(변수 할당) 3단계로 동작한다.

![변수3](/images/posts/js-variable-and-memory/3.png)

### 변수 선언과 초기화

먼저, **메모리 공간을 확보**한 후 선두 메모리 셸에 score라는 **식별자를 바인딩**한다.
이 때, 메모리 셸은 비어있을 수도 있고 이전에 저장했던 값이 들어가있을 수도 있다.
쓰레기 값이 들어가있을 수 있기 때문에 자바스크립트 엔진이 `undefined` 값을 암묵적으로 할당하여 **초기화**한다.

### 값 할당

여기서 주의할 점은 score 식별자로 0x000000F2 메모리을 찾아내어 저장된 값을 재할당하는 것이 아니라
0x00001332라는 **새로운 메모리 주소에 score 식별자를 바인딩하고 값을 할당**한다는 점이다.

## 데이터 타입과 메모리 공간

### 자바스크립트의 변수는 할당에 의해 타입이 추론된다

다시 변수와 메모리로 돌아와서 변수에 할당되는 데이터의 타입은 메모리와 연관되어 있다.
데이터 타입이 필요한 이유는 다음과 같다.

1. 값을 저장하기 위해 **확보해야 할 메모리 공간의 크기를 결정**하기 위해

2. 값을 참조할 때 **읽어들여야 할 메모리 공간의 크기를 결정**하기 위해

3. 읽어들인 **2진수 값을 어떻게 해석할지 결정**하기 위해

C나 자바 같은 정적 타입 언어는 변수 선언 시에 데이터 타입을 선언한다. ex) `char c;`
이 때 선언한 데이터 타입은 변경할 수 없으며, 타입에 맞는 값만 할당할 수 있다.
정적 타입 언어는 컴파일 시점에 타입 체크를 수행하여 통과하지 못하면 에러를 발생시키고 프로그램 실행이 불가하다.

<br />

자바스크립트는 변수를 선언할 때 타입을 선언하지 않는다. 때문에 어떠한 데이터 타입의 값이라도 자유롭게 할당할 수 있다.
즉, 자바스크립트의 변수는 **할당에 의해 타입이 추론되고, 재할당에 의해 변수의 타입이 동적으로 변할 수 있다.**
이러한 특징으로 자바스크립트는 **동적 타입 언어**이다.

### 변수에 할당할 수 있는 데이터 타입이 자유롭다면 메모리 공간의 크기는?

C와 같은 정적 타입 언어에서는 데이터 타입별로 메모리의 크기가 명확하게 정의되어 있다.
예를 들어 `int`는 4바이트, `char`는 1바이트이다. 이를 통해 한정적인 메모리의 낭비를 최소화할 수 있다.

<br />

그렇다면 자바스크립트는 데이터 타입의 크기를 어떻게 규정할까?
ECMAScript에는 숫자`Number`와 문자열`String` 타입 외의 데이터 타입의 크기를 명시적으로 규정하고 있지는 않다.

- 숫자는 64비트 부동소수점 형식으로 사용하며, 8바이트를 차지한다.
- 문자열은 각 문자당 2바이트씩 메모리를 사용하며, 문자열의 길이에 따라 메모리 크기가 동적으로 변한다.

불리언`Boolean`, 객체`Object` 등 나머지 타입에 대해서는 명시적으로 메모리 크기를 규정하지 않고 있다.
이처럼 자바스크립트가 추상적인 타입 시스템을 사용하고 있기 때문에 나머지 타입들이 어떻게 메모리에 저장되는지는 **자바스크립트 엔진 구현에 따라 다를 수 있다.**
정적 타입 언어와는 다르게 데이터 타입에 따른 메모리 크기 할당을 강제하지 않으며, 자바스크립트 엔진이 내부적으로 처리하도록 맡긴다.

<hr />

[다음글](/posts/memory-management)에서 자바스크립트가 어떻게 자동으로 메모리 관리를 하는지 정리하고자 한다.

## 참고

변수와 메모리 적재 과정 [https://hbsowo58.tistory.com/510](https://hbsowo58.tistory.com/510)

모던 자바스크립트 Deep Dive 4장, 6장
